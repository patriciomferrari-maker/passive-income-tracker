const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();

const rawData = [["Fecha", "Compra", "Venta"], ["28/12/2018", "38,50", "40,50"], ["27/12/2018", "38,00", "40,00"], ["26/12/2018", "37,75", "39,75"], ["21/12/2018", "37,00", "39,00"], ["20/12/2018", "37,00", "39,00"], ["19/12/2018", "37,00", "39,00"], ["18/12/2018", "36,50", "38,50"], ["17/12/2018", "36,50", "38,50"], ["14/12/2018", "35,65", "37,65"], ["13/12/2018", "35,65", "37,65"], ["12/12/2018", "35,50", "37,50"], ["11/12/2018", "35,50", "37,50"], ["10/12/2018", "35,50", "37,50"], ["07/12/2018", "35,50", "37,50"], ["06/12/2018", "35,50", "37,50"], ["05/12/2018", "35,00", "37,00"], ["04/12/2018", "35,00", "37,00"], ["03/12/2018", "35,00", "37,00"], ["29/11/2018", "36,00", "38,00"], ["28/11/2018", "36,00", "38,00"], ["27/11/2018", "36,50", "38,50"], ["26/11/2018", "37,00", "39,00"], ["23/11/2018", "35,50", "37,50"], ["22/11/2018", "34,50", "36,50"], ["21/11/2018", "34,30", "36,30"], ["20/11/2018", "34,26", "36,26"], ["16/11/2018", "34,06", "36,06"], ["15/11/2018", "34,09", "36,09"], ["14/11/2018", "34,00", "36,00"], ["13/11/2018", "34,00", "36,00"], ["12/11/2018", "33,25", "35,25"], ["09/11/2018", "33,50", "35,50"], ["08/11/2018", "33,50", "35,50"], ["07/11/2018", "33,50", "35,50"], ["05/11/2018", "33,60", "35,60"], ["02/11/2018", "34,25", "36,25"], ["01/11/2018", "34,25", "36,25"], ["31/10/2018", "34,50", "36,50"], ["30/10/2018", "35,00", "37,00"], ["29/10/2018", "35,00", "37,00"], ["26/10/2018", "35,25", "37,25"], ["25/10/2018", "35,20", "37,20"], ["24/10/2018", "35,20", "37,20"], ["23/10/2018", "35,30", "37,30"], ["22/10/2018", "35,25", "37,25"], ["19/10/2018", "35,75", "37,75"], ["18/10/2018", "35,75", "37,75"], ["17/10/2018", "35,70", "37,70"], ["16/10/2018", "35,70", "37,80"], ["12/10/2018", "35,80", "37,80"], ["11/10/2018", "36,00", "38,00"], ["10/10/2018", "36,00", "38,00"], ["09/10/2018", "36,00", "38,00"], ["08/10/2018", "36,00", "38,00"], ["05/10/2018", "36,50", "38,50"], ["04/10/2018", "36,80", "38,80"], ["03/10/2018", "37,00", "39,00"], ["02/10/2018", "36,50", "38,50"], ["01/10/2018", "38,00", "40,00"], ["28/09/2018", "39,30", "41,30"], ["27/09/2018", "39,00", "40,50"], ["26/09/2018", "37,75", "39,25"], ["25/09/2018", "38,50", "40,00"], ["24/09/2018", "36,75", "38,25"], ["21/09/2018", "36,75", "38,25"], ["20/09/2018", "37,50", "39,00"], ["19/09/2018", "38,00", "39,50"], ["18/09/2018", "38,00", "39,75"], ["17/09/2018", "38,35", "40,35"], ["14/09/2018", "38,00", "40,00"], ["13/09/2018", "38,00", "39,50"], ["12/09/2018", "37,00", "38,50"], ["11/09/2018", "36,50", "38,25"], ["10/09/2018", "35,70", "37,70"], ["07/09/2018", "36,50", "37,50"], ["06/09/2018", "36,60", "38,60"], ["05/09/2018", "37,20", "39,20"], ["04/09/2018", "38,00", "40,00"], ["03/09/2018", "36,70", "38,70"], ["31/08/2018", "36,00", "38,00"], ["30/08/2018", "38,50", "40,00"], ["29/08/2018", "34,00", "35,00"], ["28/08/2018", "32,00", "33,00"], ["27/08/2018", "31,20", "32,20"], ["24/08/2018", "30,35", "31,35"], ["23/08/2018", "29,95", "30,95"], ["22/08/2018", "29,80", "30,80"], ["21/08/2018", "29,50", "30,50"], ["17/08/2018", "29,20", "30,20"], ["16/08/2018", "29,10", "30,10"], ["15/08/2018", "29,50", "30,50"], ["14/08/2018", "29,50", "30,50"], ["13/08/2018", "29,50", "30,50"], ["10/08/2018", "28,50", "29,50"], ["09/08/2018", "27,50", "28,50"], ["08/08/2018", "27,30", "28,30"], ["07/08/2018", "27,30", "28,30"], ["06/08/2018", "27,30", "28,30"], ["03/08/2018", "27,35", "28,35"], ["02/08/2018", "27,40", "28,40"], ["01/08/2018", "27,45", "28,45"], ["31/07/2018", "27,45", "28,45"], ["30/07/2018", "27,65", "28,65"], ["27/07/2018", "27,70", "28,70"], ["26/07/2018", "27,70", "28,70"], ["25/07/2018", "27,70", "28,70"], ["24/07/2018", "27,70", "28,70"], ["23/07/2018", "27,80", "28,80"], ["20/07/2018", "27,90", "28,90"], ["19/07/2018", "27,65", "28,65"], ["18/07/2018", "27,65", "28,65"], ["17/07/2018", "27,80", "28,80"], ["16/07/2018", "27,85", "28,85"], ["13/07/2018", "27,68", "28,68"], ["12/07/2018", "27,40", "28,40"], ["11/07/2018", "27,50", "28,50"], ["10/07/2018", "27,50", "28,50"], ["06/07/2018", "27,90", "28,90"], ["05/07/2018", "27,90", "28,90"], ["04/07/2018", "27,97", "28,95"], ["03/07/2018", "28,00", "29,00"], ["02/07/2018", "28,30", "29,30"], ["29/06/2018", "28,40", "29,40"], ["28/06/2018", "27,50", "28,50"], ["27/06/2018", "27,30", "28,30"], ["26/06/2018", "27,30", "28,30"], ["25/06/2018", "27,30", "28,30"], ["22/06/2018", "27,10", "28,10"], ["21/06/2018", "27,50", "28,50"], ["19/06/2018", "27,50", "28,50"], ["18/06/2018", "27,50", "28,50"], ["15/06/2018", "27,70", "28,70"], ["14/06/2018", "27,20", "28 Search"], ["13/06/2018", "26,00", "27,00"], ["12/06/2018", "25,70", "26,70"], ["11/06/2018", "25,50", "26,30"], ["08/06/2018", "25,20", "26,20"], ["07/06/2018", "24,85", "25,65"], ["06/06/2018", "24,75", "25,55"], ["05/06/2018", "25,10", "25,90"], ["04/06/2018", "25,20", "26,00"], ["01/06/2018", "25,20", "26,00"]];

async function importData() {
    let created = 0;
    let updated = 0;
    let skipped = 0;

    for (let i = 1; i < rawData.length; i++) {
        const [dateStr, compraStr, ventaStr] = rawData[i];

        // Parse DD/MM/YYYY
        const [day, month, year] = dateStr.split('/');
        const date = new Date(`${year}-${month}-${day}T12:00:00Z`);

        // Parse values
        const compra = parseFloat(compraStr.replace(',', '.'));
        const venta = parseFloat(ventaStr.replace(',', '.'));
        const value = (compra + venta) / 2;

        // Check if exists
        const dayStart = new Date(date);
        dayStart.setUTCHours(0, 0, 0, 0);
        const dayEnd = new Date(date);
        dayEnd.setUTCHours(23, 59, 59, 999);

        const existing = await prisma.economicIndicator.findFirst({
            where: {
                type: 'TC_USD_ARS',
                date: { gte: dayStart, lte: dayEnd }
            }
        });

        if (existing) {
            skipped++;
        } else {
            await prisma.economicIndicator.create({
                data: {
                    type: 'TC_USD_ARS',
                    date,
                    value,
                    buyRate: compra,
                    sellRate: venta
                }
            });
            created++;
        }
    }

    console.log(`âœ… Creados: ${created}, Skipped: ${skipped}`);
    await prisma.$disconnect();
}

importData();
